<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>
      Manifest for web apps and bookmarks
    </title>
    <script src="http://www.w3.org/Tools/respec/respec-w3c-common" class=
    "remove">
</script>
    <script class='remove'>
/**/
    var respecConfig = {
    specStatus: 'ED',
    shortName: 'appmanifest',
    subtitle: 'Living Document',
    edDraftURI: 'http://w3c.github.io/manifest/',
    previousMaturity: 'FPWD',
    previousURI: 'http://www.w3.org/TR/2013/WD-appmanifest-20131217/',
    editors: [{
        name: 'Marcos Caceres',
        company: 'Mozilla Corporation',
        companyURL: 'http://mozilla.com'
    }, {
        name: 'Anssi Kostiainen',
        company: 'Intel Corporation',
        companyURL: 'http://intel.com'
    }, {
        name: 'Kenneth Rohde Christiansen',
        company: 'Intel Corporation',
        companyURL: 'http://intel.com'
    }],
    wg: 'Web Applications (WebApps) Working Group',
    wgURI: 'http://www.w3.org/2008/webapps/',
    wgPublicList: 'public-webapps',
    wgPatentURI: 'http://www.w3.org/2004/01/pp-impl/42538/status',
    otherLinks: [
        {
        key: 'Repository',
        data: [{
            value: 'We are on Github.',
            href: 'https://github.com/sysapps/manifest'
        }, {
            value: 'File a bug.',
            href: 'https://github.com/sysapps/manifest/issues'
        }, {
            value: 'Commit history.',
            href: 'https://github.com/sysapps/manifest/commits/gh-pages'
        }]
    }],
    localBiblio: {
        'FETCH': {
            'authors': [
                'Anne van Kesteren'
            ],
            'href': 'http://fetch.spec.whatwg.org/',
            'title': 'Fetch',
            'status': 'Living Standard',
            'publisher': 'WHATWG'
        }
    }
    };
    </script>
  </head>
  <body>
    <section id='abstract'>
      <p>
        This specification defines a <em>manifest</em>, which provides
        developers with a centralized place to put metadata about a web
        application. This includes, but is not limited to, the name of the web
        application, links to icons, as well as the preferred URL at which the
        web application should open when it is launched by the user.
      </p>
      <p>
        With this metadata, user agents can provide, for example, enhanced
        bookmarking capabilities such as being able to add a web application or
        site to the homescreen of a device - as well as the various icons
        needed to integrate with an OS's task switcher and system preferences.
        The specification also defines an API to enable bookmarking from within
        a document.
      </p>
      <p>
        This specification also defines the <code>manifest</code> link type,
        which provides a declarative means for a web document to be associated
        with a manifest.
      </p>
    </section>
    <section id="sotd">
      <p>
        Implementors should be aware that this specification is not stable.
        <strong>Implementors who are not taking part in the discussions are
        likely to find the specification changing out from under them in
        incompatible ways.</strong> Vendors interested in implementing this
        specification before it eventually reaches the Candidate Recommendation
        phase should join the aforementioned mailing lists and take part in the
        discussions.
      </p>
    </section>
    <section>
      <h2>
        Usage Examples
      </h2>
      <p>
        This section shows how we expect developers to make use of the various
        features of this specification.
      </p>
      <section class="informative">
        <h3>
          Example manifest
        </h3>
        <p>
          The following shows a typical <a>manifest</a>.
        </p>
        <pre class="example highlight json" title="typical manifest">
{
  "name": "Example",
  "url": "/start.html",
  "mode": "standalone",
  "icons": [{
      "src": "icon/lowres",
      "sizes": "64x64",
      "type": "image/webp"
    }, {
      "src": "icon/hd_small",
      "sizes": "64x64"
    }, {
      "src": "icon/hd_hi",
      "sizes": "128x128"
    }]
}
</pre>
      </section>
      <section>
        <h3>
          Using a <code>link</code> element to link to a manifest
        </h3>
        <p>
          Example of using a <code>link</code> element to associate a website
          with a manifest. The example also shows how certain HTML elements,
          such as a <code>meta</code> element with a name attribute whose value
          is "<span class=
          "example highlight html"><code>application-name</code></span>", can
          be used to support legacy user agents that don't implement this
          specification.
        </p>
        <pre class="example highlight html" title="linking to a manifest">
&lt;!doctype html&gt;
&lt;html&gt;
&lt;head&gt;
&lt;title&gt;The Best News - international&lt;/title&gt;

&lt;!-- link to bookmark metadata --&gt;
&lt;link rel="manifest" href="add_to_homescreen.json"&gt;

&lt;!-- fallback metadata for legacy browsers --&gt;
&lt;meta name="application-name" content="Best News!"&gt;
&lt;link rel="shortcut icon" src="favicon.ico"&gt;
&lt;/head&gt;
...
</pre>
      </section>
      <section>
        <h3>
          Using the API
        </h3>
        <p>
          Check if the application is running in <a>standalone</a> mode.
        </p>
        <pre class="example highlight html" title="detecting standalone mode">
&lt;script&gt;
if("standalone" in navigator &amp;&amp; navigator.standalone){
   //Do standalone specific stuff...
   document.documentElement.classList.add("standalone");
}
&lt;/script&gt;
</pre>
      </section>
      <section>
        <h3>
          Request adding to homescreen
        </h3>
        <p>
          Let the user bookmark the application through clicking a button.
        </p>
        <pre class="example highlight html" title=
        "requesting to bookmark a web app">
&lt;script&gt;
var installButton = document.querySelector("#install");

//Bookmarking only works if initiated by user interaction
installButton.addEventListener("click", function(e){
   navigator.requestBookmark().then(thankUser, stopBuggingUser);
});
&lt;/script&gt;

&lt;button id="install"&gt;
  Bookmark &lt;b&gt;Awesome App!&lt;/b&gt;
&lt;/button&gt;
</pre>
      </section>
    </section>
    <section>
      <h2>
        Use cases and requirements
      </h2>
      <p>
        This document attempts to address the <cite><a href=
        "http://w3c-webmob.github.io/installable-webapps/">Use Cases and
        Requirements for Installable Web Apps</a></cite>.
      </p>
    </section>
    <section>
      <h2>
        Manifest
      </h2>
      <p>
        A <dfn>manifest</dfn> is a [[!JSON]] document. Typically, it
        consists of a top-level object that contains zero or more members, some
        of which contain other objects. Each of the members, as well as how
        their values are processed, are defined below.
      </p>
      <p id="ecmascript-abstractop">
        Algorithms in this specification use the conventions described in
        [[!ECMASCRIPT]], such as the use of steps and sub-steps, and so on.
      </p>
      <p>
        The <a class="external" href=
        "http://people.mozilla.org/~jorendorff/es6-draft.html#sec-parsefloat-string">
        <dfn>parseFloat</dfn></a> method, <a class="external" href=
        "http://people.mozilla.org/~jorendorff/es6-draft.html#sec-tostring"><dfn>
        ToString</dfn></a>, <a href=
        "http://people.mozilla.org/~jorendorff/es6-draft.html#sec-hasownproperty">
        <dfn>HasOwnProperty</dfn></a>, <dfn>[[\GetOwnProperty]]</dfn>, and
        <a href=
        "http://people.mozilla.org/~jorendorff/es6-draft.html#sec-toboolean"><dfn>
        ToBoolean</dfn></a> abstract operations, <dfn>promise</dfn> objects,
        and the <a class="external" href=
        "http://people.mozilla.org/~jorendorff/es6-draft.html#sec-ecmascript-data-types-and-values">
        <dfn>Type</dfn>(<var>x</var>)</a> notation are defined in
        [[!ECMASCRIPT]]. Processing also relies on various algorithms defined
        in [[!HTML]], [[!FETCH]], and [[!URL]].
      </p>
      <p>
        As the manifest format is a [[!JSON]] document, this specification
        relies on the types defined in [[!JSON]] specification: namely <dfn id=
        "json-object">object</dfn>, <dfn id="json-array">array</dfn>, <dfn id=
        "json-number">number</dfn>, and <dfn id="json-string">string</dfn>.
        Strict type checking is not enforced by this specification. Instead,
        each member's definition specifies the steps required to process a
        particular member.
      </p>
      <p>
        When an algorithm asks the user agent to <dfn>issue a developer
        warning</dfn>, the user agent MAY report the conformance violation to
        the developer in a user-agent-specific manner (e.g., show the problem
        in the error console), or MAY ignore the error and do nothing.
      </p>
      <p>
        During processing, when instructed to <dfn>ignore</dfn>, the user agent
        MUST act as if whatever member or value caused the condition is not
        present in the manifest document.
      </p>
      <section>
        <h3>
          <code title="">name</code> member
        </h3>
        <p>
          The <dfn id="member-name"><code>name</code></dfn> is a string that
          represents the name of the application as is usually displayed to the
          user (e.g., amongst a list of other applications, or as a label
          underneath an icon).
        </p>
        <p>
          The <dfn>steps for processing the name member</dfn> is given by the
          following algorithm. The algorithm takes a <var>manifest</var> as an
          argument. It returns either <code>undefined</code>, a string, or an
          error.
        </p>
        <ol>
          <li>If <a>HasOwnProperty</a>(<var>manifest</var>, "name") returns
          <code>false</code>, then return <code>undefined</code>.
          </li>
          <li>Let <var>value</var> be the result of calling the
          [[\GetOwnProperty]] internal method of <var>manifest</var> with
          argument "name".
          </li>
          <li>If Type(<var>value</var>) is not "string", return an error.
          </li>
          <li>
            <a href=
            "http://www.whatwg.org/specs/web-apps/current-work/#strip-leading-and-trailing-whitespace">
            Strip leading and trailing whitespace</a> from <var>result</var>.
          </li>
          <li>Return the <var>result</var>.
          </li>
        </ol>
      </section>
      <section>
        <h3>
          <code>url</code> member
        </h3>
        <p>
          The <dfn id="member-launch_path">url</dfn> member is the URL that is
          <a href=
          "http://www.w3.org/html/wg/drafts/html/master/single-page.html#browsers">
          loaded</a> when the application is launched. When the developer
          omits it from the manifest, the user agent will instead use the URL
          of the document that was bookmarked.
        </p>
        <p>
          The <dfn>steps for processing the <code>url</code> member</dfn> are
          given by the following algorithm. The algorithm returns a <a href=
          "http://url.spec.whatwg.org/#concept-url">URL</a>.
        </p>
        <ol>
          <li>If <a>HasOwnProperty</a>(<var>manifest</var>, "url") is
          <code>false</code>, then return <code>undefined</code>.
          </li>
          <li>Let <var>value</var> be the result of calling the
          [[\GetOwnProperty]] internal method of the <var>manifest</var> with
          argument "<code>url</code>".
          </li>
          <li>Let <var>document URL</var> be the URL of the
          <code>document</code> from which the <var>manifest</var> was fetched
          from.
          </li>
          <li>Let <var>result</var> be a placeholder for a URL object.
          </li>
          <li>If <var>value</var> <a>Type</a>(<var>value</var>) is not
          "string":
            <ol>
              <li>
                <a>Issue a developer warning</a>.
              </li>
              <li>Set <var>result</var> to be <var>document URL</var>.
              </li>
            </ol>
          </li>
          <li>Otherwise:
            <ol>
              <li>
                <a href="http://url.spec.whatwg.org/#parsing">Parse</a>
                <var>value</var> using <var>document URL</var> as the base URL,
                and set <var>result</var> to be the result.
              </li>
            </ol>
          </li>
          <li>Return <var>result</var>.
          </li>
        </ol>
      </section>
      <section>
        <h3>
          <code title="">icons</code> member
        </h3>
        <p>
          The <dfn id="member-icons">icons</dfn> is a list of <a title=
          "icon object">icon objects</a> that represents a set of icons that
          the application can make use of.
        </p>
        <p>
          The <dfn>steps for processing the <code>icons</code> member</dfn> are
          given by the following algorithm. The algorithm returns a list of
          icons, which can be empty, or <code>undefined</code>.
        </p>
        <ol>
          <li>If <a>HasOwnProperty</a>(<var>manifest</var>, <var>key</var>)
          returns <code>false</code>, then return <code>undefined</code>.
          </li>
          <li>Let <var>icons</var> be an empty list.
          </li>
          <li>Let <var>manifest URL</var> be the URL from which the
          <var>manifest</var> was fetched.
          </li>
          <li>Let <var>unprocessed icons</var> be the result of calling the
          [[\GetOwnProperty]] internal method of <var>manifest</var> with
          argument "<code>icons</code>".
          </li>
          <li>If <a>Type</a>(<var>unprocesses icons</var>) is "array", then for
          each <var>potential icon</var> in the array:
            <ol>
              <li>Let <var>src</var> be the result of running the <a>steps for
              processing the <code>src</code> member of an icon</a>.
              </li>
              <li>If the <var>src</var> is an error or <code>undefined</code>,
              issue a developer warning, stop processing this <var>potential
              icon</var> and move to the next <var>potential icon</var> in
              <var>unprocessed icons</var>, if any.
              </li>
              <li>Let <var>type</var> be the result of running the <a>steps for
              processing the <code>type</code> member of an icon</a>.
              </li>
              <li>If <var>type</var> is not a <a href=
              "http://www.whatwg.org/specs/web-apps/current-work/#valid-mime-type">
                valid MIME type</a> or the value of type is not a supported
                icon format, then stop processing this <var>potential
                icon</var> and move to the next <var>potential icon</var> in
                <var>unprocessed icons</var>, if any.
              </li>
              <li>Otherwise, let <var>icon</var> be an object.
              </li>
            </ol>
          </li>
          <li>return <var>icons</var>.
          </li>
        </ol>
      </section>
      <section>
        <h3>
          <code>orientation</code> member
        </h3>
        <div class="issue">
          <p>
            This is <a href="https://github.com/w3c/manifest/issues/74">issue
            74</a> on GitHub. We are looking for feedback!
          </p>
          <p>
            Orientation of an application is dependent on the media features of
            the display. For example an application might need to be launched
            in landscape on phones (in order to have sufficient display width),
            but prefer to be in portrait on tablets. (see <a href=
            "http://w3c-webmob.github.io/installable-webapps/#orientation">Orientation</a>
            section in the use cases document).
          </p>
          <p>
            When analyzing applications across various runtimes, we've found
            evidence that such applications are common (e.g., basically any
            application on the iPhone that has an iPad counterpart will be
            designed to constrain to a particular orientation based on the
            device being used: LinkedIn, Flipboard, GoodReads, etc. will all go
            from portrait-primary on the iPhone to allowing "any" orientation
            on the iPad. A more extreme example is BBC iPlayer - which supports
            portrait-primary on the iPhone, but both landscape orientations on
            iPad. The same can be seen on Android devices. Unlike native apps,
            Web Apps should not target devices/OS's - they have to be device
            neutral.
          </p>
          <p>
            In order to address the use cases, we currently have two proposals.
          </p>
          <p>
            <strong>Option 1:</strong> Provide a list of orientation sets in
            the manifest. The user agent uses the first one with a matching
            media query. The order in which the orientations are listed by a
            developer does not imply a preference for setting the orientation -
            it is always left up to the user agent to pick the best orientation
            given, for example, how the user is holding the device. In the
            example below, no orientation is given for widths of 721px or
            above, so the default is used: allowing all orientations supported
            by the device.
          </p>
          <pre class="highlight">
{
    "orientations": [{
        "media": "max-width: 320px",
        "supported": ["portrait-primary", "landscape"]
    }, {
        "media": "max-width: 720px",
        "supported": ["landscape"]
    }]
}
</pre>
          <p>
            In this example:
          </p>
          <ul>
            <li>a device with a screen width of 320px or below would launch
            either "portrait-primary" or "landscape" with the abilty to be
            "flipped" depending on how the user is holding the device (and OS
            permitting).
            </li>
            <li>A device with a screen width of 321px through 720px would be
            launched in landscape (leaving it up to the UA to pick either
            landscape-primary or landscape-secondary, while allowing
            "flippability"),
            </li>
            <li>A device with a screen width of 721px and above would start in
            any orientation chosen by the UA (ideally, one that matches how the
            user is holding the device).
            </li>
          </ul>
          <p>
            <strong>Option 2:</strong> The second proposal is to remove
            orientation from the manifest and use CSS @viewport instead
            [[css-device-adapt]]. This would mean::
          </p>
          <pre class="highlight">
&lt;head&gt;
&lt;style&gt;
  /*set it by default to portrait primary for small screens */
  @media (max-width: 320px) {
      @viewport {
          orientation: portrait-primary, landscape;
      }
  }
  
  /*Tablet, switch to landscape only*/
  @media (max-width: 720px) {
      @viewport {
          orientation: landscape;
      }
  }
  
  /* 
    similarly on screens with a width of 721px or more, 
    all orientations are allowed 
   */
&lt;/style&gt;
&lt;/head&gt;
</pre>
          <p>
            Problem with using <code>@viewport</code> at the moment is that the
            specification is progressing a bit slowly and no one has
            implemented the "orientation" descriptor. It also lacks definitions
            for "-primary" and "-secondary" contraints, which are important for
            various applications, and doesn't currently allow providing
            multiple allowed orientations - hopefully the CSS Device Adaptation
            spec can align with the Screen Orientation spec.
          </p>
        </div>
        <p class="issue">
          Define the <dfn>steps for processing the orientation member</dfn>.
        </p>
      </section>
      <section>
        <h3>
          <code title="">mode</code> member
        </h3>
        <p>
          The <dfn title="member-mode">mode</dfn> member represents that mode
          of operation in which the web application will be launched. When the
          developer omits the value, the user agent assumes the value
          "bookmark".
        </p>
        <p>
          The <dfn>modes of operation</dfn> in which a web application can be
          launched include:
        </p>
        <dl>
          <dt>
            <dfn>standalone</dfn>
          </dt>
          <dd>
            Once launched, the Web application appears indistinguishable from a
            native application by allowing the OS to treat it as equivalent to
            a native application.
          </dd>
          <dt>
            <dfn>bookmark</dfn>
          </dt>
          <dd>
            When launched, the user agent open the URL is normal (e.g., opens a
            new tab, or a new window, or whatever it commonly does when
            instructed to open a bookmark).
          </dd>
        </dl>
        <p>
          Standalone mode can also be displayed in the following view modes:(?)
        </p>
        <p>
          A <dfn>valid application mode</dfn> is one that conforms to the
          following [[!ABNF]]:
        </p>
        <pre>
  mode = "bookmark" / "standalone" ["-" presentation]
  presentation = "fullscreen"
</pre>
        <p>
          The <dfn>steps for processing the <code>mode</code> member</dfn> are
          given by the following algorithm. The algorithm returns a string.
        </p>
        <ol>
          <li>Let <var>value</var> be the result of calling the
          [[\GetOwnProperty]] internal method of <var>manifest</var> passing
          "<code>mode</code>" as the argument.
          </li>
          <li>Let <var>result</var> be "bookmark".
          </li>
          <li>
            <a href=
            "http://www.whatwg.org/specs/web-apps/current-work/#strip-leading-and-trailing-whitespace">
            Strip leading and trailing whitespace</a> from <var>value</var>.
          </li>
          <li>If <var>value</var> is a <a>valid application mode</a>, set <var>
            result</var> to <var>value</var>.
          </li>
          <li>Return <var>result</var>.
          </li>
        </ol>
      </section>
      <section>
        <h3>
          Processing the manifest
        </h3>
        <p>
          The <dfn>steps for fetching a manifest</dfn> are given by the
          following algorithm. It takes a <var>url</var> URL as an argument. It
          returns a response (which may be an error).
        </p>
        <ol>
          <li>Let <var>response</var> be the result of <a href=
          "http://fetch.spec.whatwg.org/#concept-fetch">fetching</a> the
          manifest from <var>url</var>.
          </li>
          <li>Return <var>response</var>.
          </li>
        </ol>
        <p>
          The <dfn>steps for processing a manifest</dfn> are given by the
          following algorithm. The algorithm takes a <var>text</var> string as
          an argument.
        </p>
        <ol>
          <li>Let <var>manifest</var> be the result of invoking the <a href=
          "https://people.mozilla.org/~jorendorff/es6-draft.html#sec-json.parse">
            parse</a> function of the JSON object defined in [[!ECMASCRIPT]]
            with <var>text</var> as its only argument. If parsing throws an
            error:
            <ol>
              <li>Issue a developer warning.
              </li>
              <li>Invoke <a href=
              "https://people.mozilla.com/~jorendorff/es6-draft.html#sec-15.12.2">
                parse</a> with <code>"{}"</code> as the arugment and set
                manifest to the result.
              </li>
            </ol>
          </li>
          <li>Let <var>name</var> be the result of running the <a>steps for
          processing the <code>name</code> member</a>. If the returned value is
          <code>undefined</code> or an error:
            <ol>
              <li>Optionally, if <var>value</var> is an error, <a>issue a
              developer warning</a>.
              </li>
              <li>Set <var>name</var> to be an implementation specific string
              that can serve as a suitable name for the web application. For
              example, if the manifest was obtained from a <code>link</code>
              element, and the <code>document</code> has a <code>meta</code>
              element whose <code>name</code> attribute matches
                "<code><a href="http://www.whatwg.org/specs/web-apps/current-work/#meta-application-name">application-name</a></code>",
                then the user agent could use the value of that
                <code>meta</code> element's <code>content</code> attribute as a
                fallback.
              </li>
            </ol>
          </li>
          <li>Let <var>mode</var> be the result of running the <a>steps for
          processing the <code>mode</code> member</a>. If processing returns an
          error, report the error, and set <var>mode</var> to
          "<code>bookmark</code>".
          </li>
          <li>Let <var>orientation</var> be the result of running the <a>steps
          for processing the <code>orientation</code> member</a>.
          </li>
          <li>Let <var>url</var> be the result of running the <a>steps for
          processing the <code>url</code> member</a>.
          </li>
          <li>Let <var>icons</var> be the result of running the <a>steps for
          processing the <code>icons</code> member</a>.
          </li>
          <li>Optionally, <a>ignore</a> all other members.
          </li>
          <li>Return response.
          </li>
        </ol>
        <p>
          The <dfn>steps to get the web application's metadata</dfn> are given
          by the following algorithm:
        </p>
        <ol>
          <li>...
          </li>
        </ol>
      </section>
      <section id="linking">
        <h3>
          Linking to a manifest
        </h3>
        <p>
          The <code>manifest</code> keyword can be used with a [[!HTML]]
          <a href=
          "http://www.whatwg.org/specs/web-apps/current-work/#the-link-element">
          link</a> element. This keyword creates an <a href=
          "http://www.whatwg.org/specs/web-apps/current-work/#external-resource-link"
          title="external resource link">external resource link</a>.
        </p>
        <table border="1">
          <tr>
            <th rowspan="2">
              Link type
            </th>
            <th colspan="2">
              Effect on...
            </th>
            <th rowspan="2">
              Brief description
            </th>
          </tr>
          <tr>
            <th>
              <code><a href="#the-link-element">link</a></code>
            </th>
            <th>
              <code><a href="#the-a-element">a</a></code> and <code><a href=
              "#the-area-element">area</a></code>
            </th>
          </tr>
          <tr>
            <td>
              <code title="rel-manifest">manifest</code>
            </td><!-- second most used <link rel> value -->
            <td>
              <a href=
              "http://www.whatwg.org/specs/web-apps/current-work/#external-resource-link"
              title="external resource link">External Resource</a>
            </td>
            <td>
              not allowed
            </td>
            <td>
              Imports or links to a manifest.
            </td>
          </tr>
        </table>
        <p>
          The default media type for resources associated with the
          <code>manifest</code> <a href=
          "http://www.whatwg.org/specs/web-apps/current-work/#linkTypes">link
          type</a> is <code>application/manifest+json</code>.
        </p>
        <p>
          In cases where more than one <a href=
          "http://www.whatwg.org/specs/web-apps/current-work/#the-link-element">
          <code>link</code></a> element with a <code>manifest</code> link type
          appears in a <code>document</code>, the user agent MUST use the first
          inserted link element and ignore all subsequent <a href=
          "http://www.whatwg.org/specs/web-apps/current-work/#the-link-element">
          <code>link</code></a> elements with a <code>manifest</code> link type
          (even if the first element was in error).
        </p>
        <p>
          The appropriate time to <a href=
          "http://fetch.spec.whatwg.org/#concept-fetch">fetch</a> the manifest
          is when the <a href=
          "http://www.whatwg.org/specs/web-apps/current-work/#external-resource-link"
          title="external resource link">external resource link</a> is created
          or when its element is <a href=
          "http://www.whatwg.org/specs/web-apps/current-work/#insert-an-element-into-a-document"
          title="insert an element into a document">inserted into a
          document</a>, whichever happens last. However, a user agent MAY opt
          to delay fetching a manifest until after the document and its other
          resources have loaded (i.e., to not delay the availability of content
          and scripts required by the <code>document</code>).
        </p>
        <p>
          Certain error conditions can result in a manifest being treated as an
          <a>invalid manifest</a>. An <dfn>invalid manifest</dfn> is one that
          is deemed to be non-conforming in such a way that it would not be
          possible for the user agent to continue processing (e.g., it can't be
          parsed by the JSON parser because of a syntax error, it could be
          fetched from the network). In such a case, it is RECOMMENDED that the
          user agent <a>issue a developer warning</a>. In either case, when a
          step results in an <a>invalid manifest</a> the user agent MUST abort
          whatever step or sub-step caused the condition.
        </p>
        <p>
          To obtain a manifest, a user agent MUST:
        </p>
        <ol>
          <li>If the <code>link</code> element lacks a href attribute, abort
          this algorithm.
          </li>
          <li>Run the <a>steps for fetching a manifest</a>, with the value of
          <code>href</code> attribute as the url, and let <var>response</var>
          be the response.
          </li>
          <li>If response's type is "error", treat this as an <span>invalid
          manifest</span>.
          </li>
          <li>Otherwise, let <var>manifest</var> be the result of running the
          <a>steps for processing a manifest</a>.
          </li>
          <li>If <var>manifest</var> results in an error, treat this as an
          <span>invalid manifest</span>.
          </li>
          <li>Otherwise, in a user agent specific manner, and when the end-user
          so desires, provide a means for the end-user to view the relevant
          contents of the <var>manifest</var>; and provide a means for the
          end-user to create a bookmark based on that information.
          </li>
        </ol>
      </section>
      <section id="proprietary-extensions" class="informative">
        <h3>
          Proprietary extensions to the manifest
        </h3>
        <p>
          Although proprietary extensions are undesirable, they can't
          realistically be avoided. As such, the RECOMMENDED way to add
          proprietary extension is to use a vendor prefix.
        </p>
        <p>
          This following is an example of two hypothetical vendor extensions.
        </p>
        <pre class="example highlight json" title="vendor extensions">
{
  ...
  "webkit-fancyfeature": "some/url/img",
  "moz-awesome-thing": { ... }
  ...
}
</pre>
      </section>
    </section>
    <section>
      <h2>
        Launching a standalone web application
      </h2>
      <p>
        When an application is launched:
      </p>
      <ol>
        <li>If the web application has a required orientation, run the
        <span>steps for selecting the orientation</span>.
        </li>
      </ol>
    </section>
    <section>
      <h2>
        Icon object and its members
      </h2>
      <p>
        Each <dfn>icon object</dfn> represents an icon for an application
        suitable to use in various contexts (e.g., an application menu).
      </p>
      <section>
        <h3>
          <code>sizes</code> members
        </h3>
        <p>
          The <dfn title="icon-sizes">sizes</dfn> members represent the natural
          width of the icon in pixels. Their corresponding value is a positive
          number greater than 0.
        </p>
        <p>
          The <dfn>steps for processing a dimension of an icon</dfn> are given
          by the following algorithm. The algorithm takes an <var>icon</var>
          and a <var>key</var> ("width" or "height") as an argument. The
          algorithm returns a positive number, <code>undefined</code>, or an
          error.
        </p>
        <ol>
          <li>If <a>HasOwnProperty</a>(<var>icon</var>, <var>key</var>) returns
          <code>false</code>, then return <code>undefined</code>.
          </li>
          <li>Let <var>value</var> be the result of calling the
          [[\GetOwnProperty]] internal method of <var>icon</var> passing <var>
            key</var> as the argument.
          </li>
          <li>Process <var>value</var> as if it was it was the value of sizes
          attribute and let <var>width</var> and <var>height</var> be the
          result.
          </li>
        </ol>
      </section>
      <section>
        <h3>
          <code>src</code> member
        </h3>
        <p>
          The <dfn title="icon-density">src</dfn> member of an icon is a URL
          from which the icon can be fetched.
        </p>
        <p>
          The <dfn>steps for processing the <code>src</code> member of an
          icon</dfn> are given by the following algorithm. The algorithm takes
          a <var>icon</var> object as an argument and returns a URL or
          <code>undefined</code>.
        </p>
        <ol>
          <li>If <a>HasOwnProperty</a>(<var>icon</var>, "src") returns
          <code>false</code>, then return <code>undefined</code>.
          </li>
          <li>Let <var>value</var> be the result of calling the
          [[\GetOwnProperty]] internal method of <var>icon</var> passing
          "<code>src</code>" as the argument.
          </li>
          <li>Let <var>manifest URL</var> be the URL from which the
          <var>manifest</var> was fetched from.
          </li>
          <li>
            <a href="http://url.spec.whatwg.org/#parsing">Parse</a>
            <var>value</var>, using <var>manifest URL</var> as the base URL,
            and let <var>result</var> be the result.
          </li>
          <li>return <var>result</var>.
          </li>
        </ol>
      </section>
      <section>
        <h3>
          <code>type</code> member
        </h3>
        <p>
          The <dfn title="icon-type">type</dfn> member of an icon is a hint as
          to the media type of the icon. The purpose of this member is to allow
          a user agent to ignore icons of media types it does not support.
        </p>
        <p>
          The <dfn>steps for processing the <code>type</code> member of an
          icon</dfn> are given by the following algorithm. The algorithm takes
          an <var>icon</var> object as an argument, and returns either a string. an error
          or <code>undefined</code>.
        </p>
        <ol>
          <li>If <a>HasOwnProperty</a>(<var>manifest</var>,"type") returns
          <code>false</code>, then return <code>undefined</code>.
          </li>
          <li>Let <var>value</var> be the result of calling the
          [[\GetOwnProperty]] internal method of <var>potential icon</var>
          passing "<code>type</code>" as the argument.
          </li>
          <li>If type(<var>potential src</var>) is not "string", return an
          error.
          </li>
          <li>
            <a href=
            "http://www.whatwg.org/specs/web-apps/current-work/#strip-leading-and-trailing-whitespace">
            Strip leading and trailing whitespace</a> from <var>result</var>.
          </li>
          <li>return <var>result</var>.
          </li>
        </ol>
      </section>
    </section>
    <section>
      <h2>
        Extensions to the <code>Navigator</code> object
      </h2>
      <dl class="idl" title="partial interface Navigator">
        <dt>
          readonly attribute Boolean standalone
        </dt>
        <dd>
          The standalone attribute provides a means for a developer to check if
          the application is running in <a>standalone</a> mode. When getting,
          the user agent MUST return <code>true</code> if the application is
          running as <a>standalone</a>. Return <code>false</code> otherwise.
        </dd>
        <dt>
          Promise requestBookmark()
        </dt>
        <dd>
          When invoked, the user agent MUST run the <a>steps to request to add
          bookmark</a>.
        </dd>
      </dl>
      <p>
        The <dfn>steps to request to add a bookmark</dfn> are given by the
        following algorithm. The algorithm returns a promise.
      </p>
      <ol>
        <li>Let <var>promise</var> be a newly-created <a>promise</a>.
        </li>
        <li>If this method was not invoked as a result of explicit user action,
        then:
          <ol>
            <li>Reject <var>promise</var> with new <code><a href=
            "http://dom.spec.whatwg.org/#exception-domexception">DOMException</a></code>
            whose name is "<code><a href=
            "http://dom.spec.whatwg.org/#securityerror">SecurityError</a></code>"
            and return.
            </li>
          </ol>
        </li>
        <li>If the document's <a>mode of operation</a> is <a>standalone</a>:
          <ol>
            <li>Reject <var>promise</var> with a new <code><a href=
            "http://dom.spec.whatwg.org/#exception-domexception">DOMException</a></code>
            whose name is "<code><a href=
            "http://dom.spec.whatwg.org/#notsupportederror">NotSupported</a></code>"
            and return.
            </li>
          </ol>
        </li>
        <li>Let <var>info</var> be the result of getting a web application's
        metadata.
        </li>
        <li>Using <var>info</var>, and in a manner that is user-agent specific,
        allow the end user to make a choice as to whether they want to add the
        bookmark:
          <ol>
            <li>If the end-user aborts the request to add the bookmark (e.g.,
            they hit escape, or press a "cancel" button), then Reject
            <var>promise</var> with a new <code><a href=
            "http://dom.spec.whatwg.org/#exception-domexception">DOMException</a></code>
            whose name is "<code><a href=
            "http://dom.spec.whatwg.org/#aborterror">AbortError</a></code>" and
            return.
            </li>
            <li>Otherwise, resolve <var>promise</var> with
            <code>undefined</code>.
            </li>
          </ol>
        </li>
        <li>Return <var>promise</var>.
        </li>
      </ol>
    </section>
    <section>
      <h2>
        IANA considerations
      </h2>
      <p>
        The following registration is for community review and will be
        submitted to the IESG for review, approval, and registration with IANA.
      </p>
      <section>
        <h3>
          The "manifest.json" well-known URI
        </h3>
        <p>
          In the absence of a <code>link</code> element with the
          <code>manifest</code> keyword, for <code>Documents</code> obtained
          over HTTP or HTTPS or [[!APP-URI]], user agents MAY instead attempt
          to <a href="http://fetch.spec.whatwg.org/#concept-fetch">fetch</a>
          and use a manifest with the <a href=
          "http://url.spec.whatwg.org/#concept-absolute-url">absolute URL</a>
          obtained by resolving the URL
          "<code>.well-known/manifest.json</code>" against <a href=
          "http://www.whatwg.org/specs/web-apps/current-work/#the-document's-address">
          the document's address</a>, as if the page had declared that
          <a>manifest</a> using the <code>manifest</code> keyword.
        </p>
        <p>
          This specification registers the "manifest.json" well-known URI in
          the <a href=
          "http://www.iana.org/assignments/well-known-uris/well-known-uris.xml">
          Well-Known URI Registry</a> as required by [[!RFC5785]].
        </p>
        <dl>
          <dt>
            URI suffix:
          </dt>
          <dd>
            manifest.json
          </dd>
          <dt>
            Change controller:
          </dt>
          <dd>
            <a href="www.w3.org/2008/webapps/">Web Applications (WebApps)
            Working Group</a>
          </dd>
          <dt>
            Specification document(s):
          </dt>
          <dd>
            This document is the relevant specification.
          </dd>
        </dl>
      </section>
      <section>
        <h3>
          Media type reregistration
        </h3>
        <p>
          This section contains the required text for MIME media type
          registration with IANA.
        </p>
        <p>
          The <dfn>media type for a manifest</dfn> is
          <code>application/manifest+json</code>.
        </p>
        <p>
          If the protocol over which the manifest is transferred supports the
          [[!MIME-TYPES]] specification (e.g. HTTP), it is RECOMMENDED that the
          manifest be labeled with the <a>media type for a manifest</a>.
        </p>
        <dl>
          <dt>
            Type name:
          </dt>
          <dd>
            application
          </dd>
          <dt>
            Subtype name:
          </dt>
          <dd>
            manifest+json
          </dd>
          <dt>
            Required parameters:
          </dt>
          <dd>
            N/A
          </dd>
          <dt>
            Optional parameters:
          </dt>
          <dd>
            N/A
          </dd>
          <dt>
            Encoding considerations:
          </dt>
          <dd>
            Same as for application/json
          </dd>
          <dt>
            Security considerations:
          </dt>
          <dd>
            <p>
              As the manifest format is JSON and will commonly be encoded using
              [[!UNICODE]], the security considerations described in [[!JSON]]
              and [[!UNICODE-SECURITY]] apply. In addition, implementors need
              to impose their own implementation-specific limits on the values
              of otherwise unconstrained member types, e.g. to prevent denial
              of service attacks, to guard against running out of memory, or to
              work around platform-specific limitations.
            </p>
            <p>
              Web applications will generally contain ECMAScript, HTML, CSS
              files, and other media, which are executed in a sand-boxed
              environment. As such, implementors need to be aware of the
              security implications for the types they support. Specifically,
              implementors need to consider the security implications outlined
              in the [[!CSS-MIME]] specification, the [[!ECMAScript-MIME]]
              specification, and the [[!HTML]] specification.
            </p>
            <p>
              As web applications can contain content that is able to
              simultaneously interact with the local device and a remote host,
              implementors need to consider the privacy implications resulting
              from exposing private information to a remote host. Mitigation
              and in-depth defensive measures are an implementation
              responsibility and not prescribed by this specification. However,
              in designing these measures, implementors are advised to enable
              user awareness of information sharing, and to provide easy access
              to interfaces that enable revocation of permissions.
            </p>
            <p>
              As this specification allows for the declaration of URLs within
              certain members of a manifest, implementors need to consider the
              security considerations discussed in the [[!URL]] specification.
              Implementations intending to display <abbr title=
              "Internationalized Resource Identifiers">IRIs</abbr> and
              <abbr title="Internationalized domain name">IDNA</abbr> addresses
              found in the manifest are strongly encouraged to follow the
              security advice given in [[!UNICODE-SECURITY]].
            </p>
          </dd>
          <dt>
            Applications that use this media type:
          </dt>
          <dd>
            Web browsers
          </dd>
          <dt>
            Additional information:
          </dt>
          <dd>
            <dl>
              <dt>
                Magic number(s):
              </dt>
              <dd>
                N/A
              </dd>
              <dt>
                File extension(s):
              </dt>
              <dd>
                .json, .manifest
              </dd>
              <dt>
                Macintosh file type code(s):
              </dt>
              <dd>
                TEXT
              </dd>
            </dl>
          </dd>
          <dt>
            Person &amp; email address to contact for further information:
          </dt>
          <dd>
            The <a href="http://www.w3.org/2008/webapps/" rel="nofollow">Web
            Applications (WebApps) Working Group</a> can be contacted at
            <a href="http://lists.w3.org/Archives/Public/public-webapps/" rel=
            "nofollow">public-webapps@w3.org</a>.
          </dd>
          <dt>
            Intended usage:
          </dt>
          <dd>
            COMMON
          </dd>
          <dt>
            Restrictions on usage:
          </dt>
          <dd>
            none
          </dd>
          <dt>
            Author:
          </dt>
          <dd>
            W3C's Web Applications (WebApps) Working Group.
          </dd>
          <dt>
            Change controller:
          </dt>
          <dd>
            W3C.
          </dd>
        </dl>
      </section>
    </section>
    <section id="conformance" data-status="done">
      <p>
        There is only one class of product that can claim conformance to this
        specification: a <dfn>user agent</dfn>.
      </p>
    </section>
    <section class="appendix">
      <h2>
        Acknowledgments
      </h2>
      <p>
        This document reuses text from the WHATWG [[!HTML]] specification as
        permitted by the license of that specification. The [[!HTML]]
        specification is edited by Ian Hickson.
      </p>
    </section>
  </body>
</html>
